import{d as e,A as a,B as l,C as s,o as n,h as t,g as o,b as r,w as i,D as c,E as d,F as u,r as m,e as v,t as p,f as h,G as U,H as f,j as g,I as x,J as C}from"./index-BpLMNI0G.js";import{p as D}from"./index.DfEtVRDy.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./_commonjsHelpers.MdiGH4nz.js";const k=w(e({name:"ChatbotPage",setup(){const e=a(null),n=a(!1),t=a(!1),o=a(new UTSJSONObject({name:"",id:"",xmlData:""})),r=a([new UTSJSONObject({id:"user001",name:"å¼ ä¸‰",xmlData:'<?xml version="1.0" encoding="UTF-8"?>'}),new UTSJSONObject({id:"user002",name:"æå››",xmlData:"<user><name>æå››</name><role>user</role></user>"}),new UTSJSONObject({id:"user003",name:"ç‹äº”",xmlData:"<user><name>ç‹äº”</name><role>guest</role></user>"})]),i=l(()=>{if(!e.value||!e.value.xmlData)return"";try{const a=D.gzip(e.value.xmlData);return btoa(String.fromCharCode.apply(null,a))}catch(a){return console.error("å‹ç¼©ç¼–ç å¤±è´¥:",a),""}}),c=l(()=>{const e="https://udify.app/chatbot/W6KLjKIF1kLPBQ8H";return i.value?"".concat(e,"?xml=").concat(encodeURIComponent(i.value)):e}),d=()=>{n.value=!1};return s(()=>{r.value.length>0&&(e.value=r.value[0])}),new UTSJSONObject({selectedUser:e,users:r,showAddDialog:n,isMinimized:t,newUser:o,currentXmlParam:i,iframeSrc:c,switchUser:()=>{console.log("åˆ‡æ¢ç”¨æˆ·:",e.value)},minimizeChat:()=>{t.value=!0,console.log("èŠå¤©ç•Œé¢å·²æœ€å°åŒ–")},expandChat:()=>{t.value=!1,console.log("èŠå¤©ç•Œé¢å·²å±•å¼€")},addUser:()=>{n.value=!0,o.value={name:"",id:"",xmlData:""}},saveUser:()=>o.value.name&&o.value.id?UTS.arrayFind(r.value,e=>e.id===o.value.id)?(alert("ç”¨æˆ·IDå·²å­˜åœ¨"),null):(r.value.push({id:o.value.id,name:o.value.name,xmlData:o.value.xmlData||"<user><name>".concat(o.value.name,"</name><id>").concat(o.value.id,"</id></user>")}),void d()):(alert("è¯·å¡«å†™ç”¨æˆ·åç§°å’ŒID"),null),closeDialog:d})}}),[["render",function(e,a,l,s,D,w){const k=f,b=g,S=x,j=C;return n(),t("div",{class:"chat-container"},[o("div",{class:"header"},[o("h2",null,"èŠå¤©æœºå™¨äºº"),o("div",{class:"user-selector"},[r(k,{for:"userSelect"},{default:i(()=>[v("é€‰æ‹©ç”¨æˆ·ï¼š")]),_:1}),c(o("select",{id:"userSelect","onUpdate:modelValue":a[0]||(a[0]=e=>s.selectedUser=e),onChange:a[1]||(a[1]=(...e)=>s.switchUser&&s.switchUser(...e))},[(n(!0),t(u,null,m(s.users,e=>(n(),t("option",{key:e.id,value:e},p(e.name),9,["value"]))),128))],544),[[d,s.selectedUser]]),r(b,{onClick:s.addUser,class:"add-btn"},{default:i(()=>[v("æ·»åŠ ç”¨æˆ·")]),_:1},8,["onClick"])])]),s.selectedUser?(n(),t("div",{key:0,class:"user-info"},[o("p",null,[o("strong",null,"å½“å‰ç”¨æˆ·ï¼š"),v(p(s.selectedUser.name),1)]),o("p",null,[o("strong",null,"ç”¨æˆ·IDï¼š"),v(p(s.selectedUser.id),1)]),o("p",null,[o("strong",null,"XMLå‚æ•°ï¼š"),v(p(s.currentXmlParam),1)])])):h("",!0),s.isMinimized?h("",!0):(n(),t("div",{key:1,class:"iframe-container"},[o("div",{class:"chat-header"},[o("h3",null,"èŠå¤©ç•Œé¢"),o("div",{class:"chat-controls"},[r(b,{onClick:s.minimizeChat,class:"minimize-btn",title:"æœ€å°åŒ–"},{default:i(()=>[o("span",null,"â”€")]),_:1},8,["onClick"])])]),o("iframe",{src:s.iframeSrc,style:{width:"100%",height:"100%","min-height":"700px"},frameborder:"0",allow:"microphone",ref:"chatIframe"},null,8,["src"])])),s.isMinimized?(n(),t("div",{key:2,class:"minimized-chat"},[r(b,{onClick:s.expandChat,class:"expand-btn"},{default:i(()=>[o("span",null,"ğŸ’¬"),o("span",null,"ç‚¹å‡»å±•å¼€èŠå¤©")]),_:1},8,["onClick"])])):h("",!0),s.showAddDialog?(n(),t("div",{key:3,class:"modal-overlay",onClick:a[6]||(a[6]=(...e)=>s.closeDialog&&s.closeDialog(...e))},[o("div",{class:"modal",onClick:a[5]||(a[5]=U(()=>{},["stop"]))},[o("h3",null,"æ·»åŠ æ–°ç”¨æˆ·"),r(S,{modelValue:s.newUser.name,"onUpdate:modelValue":a[2]||(a[2]=e=>s.newUser.name=e),placeholder:"ç”¨æˆ·åç§°",class:"input-field"},null,8,["modelValue"]),r(S,{modelValue:s.newUser.id,"onUpdate:modelValue":a[3]||(a[3]=e=>s.newUser.id=e),placeholder:"ç”¨æˆ·ID",class:"input-field"},null,8,["modelValue"]),r(j,{modelValue:s.newUser.xmlData,"onUpdate:modelValue":a[4]||(a[4]=e=>s.newUser.xmlData=e),placeholder:"XMLæ•°æ®ï¼ˆå¯é€‰ï¼‰",class:"textarea-field",rows:"4"},null,8,["modelValue"]),o("div",{class:"modal-buttons"},[r(b,{onClick:s.saveUser,class:"save-btn"},{default:i(()=>[v("ä¿å­˜")]),_:1},8,["onClick"]),r(b,{onClick:s.closeDialog,class:"cancel-btn"},{default:i(()=>[v("å–æ¶ˆ")]),_:1},8,["onClick"])])])])):h("",!0)])}],["__scopeId","data-v-32f2833d"]]);export{k as default};
