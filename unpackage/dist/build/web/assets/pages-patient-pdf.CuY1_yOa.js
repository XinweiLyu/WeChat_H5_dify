import{d as e,o as t,h as o,b as r,_ as n}from"./index-BpLMNI0G.js";import{_ as a,a as s,g as i}from"./config.CVVdX77V.js";import{p as c}from"./pdf_viewer.27HWn5OB.js";import{_ as d}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./_commonjsHelpers.MdiGH4nz.js";const p=i();c.GlobalWorkerOptions.workerSrc="/static/pdf.worker.min.js";const l=d(e({name:"",components:{},data:()=>({userId:""}),created(){this.userId=this.$route.query.report_id},mounted(){this.$nextTick(()=>{this.handleReport(),this.$forceUpdate()})},methods:{handleReport(){return a(this,void 0,void 0,(function*(){try{const e=yield s({method:"get",url:"".concat(p.baseURL,"/report/wechat-export"),params:new UTSJSONObject({report_id:this.userId}),responseType:"arraybuffer",headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log("getUserPdf 接口返回：",e.data);const t=new Blob([e.data],new UTSJSONObject({type:"application/pdf"})),o=URL.createObjectURL(t),r=c.getDocument(new UTSJSONObject({url:o,cMapUrl:"/static/cmaps/",cMapPacked:!0})),n=yield r.promise,a=document.getElementById("container");a.innerHTML="";const i=1.5;for(let s=1;s<=n.numPages;s++){const e=yield n.getPage(s),t=e.getViewport(new UTSJSONObject({scale:i})),o=document.createElement("canvas"),r=o.getContext("2d");o.height=t.height,o.width=t.width,a.appendChild(o),yield e.render(new UTSJSONObject({canvasContext:r,viewport:t})).promise;const d=yield e.getTextContent(),p=document.createElement("div");p.className="textLayer",a.appendChild(p),c.renderTextLayer(new UTSJSONObject({textContent:d,container:p,viewport:t,textDivs:[]}))}}catch(e){console.log(e)}}))}},computed:{}}),[["render",function(e,a,s,i,c,d){const p=n;return t(),o("div",null,[r(p,{id:"container"})])}]]);export{l as default};
