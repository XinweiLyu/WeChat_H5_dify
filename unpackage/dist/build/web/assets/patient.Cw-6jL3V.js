var e=Object.defineProperty,r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,a=(r,o,t)=>o in r?e(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t;import{a as s}from"./index-BpLMNI0G.js";import{a as n,g as l}from"./config.CVVdX77V.js";const c=l(),i=n.create({baseURL:c.baseURL,timeout:3e4,headers:{"Content-Type":"application/json"}});function p(e,s,n={}){return console.log(e,s,"params"),i.get(e,((e,s)=>{for(var n in s||(s={}))o.call(s,n)&&a(e,n,s[n]);if(r)for(var n of r(s))t.call(s,n)&&a(e,n,s[n]);return e})({params:s},n))}i.interceptors.request.use(e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),i.interceptors.response.use(e=>{var r;if(console.log("response",e),e.data.results&&200===e.data.results.code)return e.data;if(200===e.data.code)return e.data;{const o=(null==(r=e.data.results)?void 0:r.message)||e.data.message||"请求失败";return console.error("API Error:",o),Promise.reject(new Error(o))}},e=>{var r,o;return console.log("401跳转开始",null==(o=null==(r=e.response)?void 0:r.data)?void 0:o.code),e.response&&401===e.response.status&&(localStorage.removeItem("token"),localStorage.removeItem("wechat_user_info"),console.log("401错误：用户未授权或token已过期"),"undefined"!=typeof uni&&s({title:"请重新授权",icon:"none",duration:2e3})),console.error("Network Error:",e),console.log("error.response",e.response),Promise.reject(e)});const u=e=>p("/report/wechat-reports/",e),d=e=>p("/report/wechat-xml/",e);export{u as a,d as b,p as g};
